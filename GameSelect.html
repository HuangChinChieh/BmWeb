<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BM</title>
    <link rel="shortcut icon" href="images/logo_300.png" />
    <link rel="Bookmark" href="images/logo_300.png" />
    <script type="text/javascript" src="Scripts/MultiLanguage.js"></script>
    <script type="text/javascript" src="Scripts/bignumber.min.js"></script>
    <style>
        .selTitle {
            display: inline-block;
            color: white
        }
        /*   PC端樣式    */
        @media (min-width: 768px) {
            button {
                margin: 0;
                padding: 0;
                border: 1px solid transparent;
                outline: none;
                background-color: transparent;
            }

            .containerBrand {
                height: calc(100vh - 430px);
                display: flex;
                flex-direction: column;
                flex-wrap: nowrap;
                justify-content: center;
                align-items: center;
                min-height: 320px;
            }

            .brand:nth-child(odd) {
                background: url(images/btn-back-gray.png) no-repeat;
                background-size: 250px 60px;
            }

                .brand:nth-child(odd) > button {
                    color: #322b28;
                }

            .brand:nth-child(even) {
                background: url(images/btn-back-black.png) no-repeat;
                background-size: 250px 60px;
            }

                .brand:nth-child(even) > button {
                    color: #fcfcfc;
                }

            .brand {
                width: 250px;
                height: 60px;
                margin-bottom: 40px
            }

                .brand:hover {
                    transform: scale(1.10);
                    animation: brandFocus 4s linear infinite;
                }

                .brand > button {
                    width: 250px;
                    font-size: 24px;
                    line-height: 60px;
                    cursor: pointer;
                    font-family: monospace;
                }

            @keyframes brandFocus {
                0% {
                    filter: contrast(0.5);
                }

                50% {
                    filter: contrast(1.0);
                }

                100% {
                    filter: contrast(0.5);
                }
            }


            .langSel_container {
                text-align: center;
                height: 40px;
                margin: 10px 10px 10px 40px;
            }

            .langSel {
                margin: 0px 35px 15px 0px;
                background-color: rgba(8, 7, 6, 0.8);
                border: 1px solid #d9c38f;
                width: auto;
                /* height: 50px; */
                color: white;
                font-size: 18px;
            }

                .langSel option {
                    color: white;
                    font-size: 18px;
                }

            .image_1 {
                width: 240px;
                height: 240px;
                margin: 30px 180px 40px 180px;
            }

            .image-wrapper_1 {
                width: 600px;
                max-width: 100vw;
                height: auto;
                margin: auto;
                background-color: rgba(8, 7, 6, 0.8);
                padding: 0px 60px;
                min-height: 100vh;
            }
        }

        /*   移動端樣式    */
        @media (max-width: 767px) {
            .selContainer {
                height: 90px;
                display: flex;
                flex-direction: column;
                align-items: center;
                flex-wrap: nowrap;
                justify-content: space-evenly;
            }

            button {
                margin: 0;
                padding: 0;
                border: 1px solid transparent;
                outline: none;
                background-color: transparent;
            }

            .containerBrand {
                height: calc(100vh - 50vw - 90px);
                display: flex;
                flex-direction: column;
                flex-wrap: nowrap;
                justify-content: center;
                align-items: center;
                min-height: 320px;
            }

            .brand:nth-child(odd) {
                background: url(images/btn-back-gray.png) no-repeat;
                background-size: contain;
            }

                .brand:nth-child(odd) > button {
                    color: #322b28;
                }

            .brand:nth-child(even) {
                background: url(images/btn-back-black.png) no-repeat;
                background-size: contain;
            }

                .brand:nth-child(even) > button {
                    color: #fcfcfc;
                }

            .brand {
                width: auto;
                height: auto;
                margin-bottom: 40px
            }

                .brand:hover {
                    transform: scale(1.10);
                    animation: brandFocus 4s linear infinite;
                }

                .brand > button {
                    width: 260px;
                    font-size: 24px;
                    line-height: 65px;
                    cursor: pointer;
                    font-family: Georgia;
                }

            @keyframes brandFocus {
                0% {
                    filter: contrast(0.5);
                }

                50% {
                    filter: contrast(1.0);
                }

                100% {
                    filter: contrast(0.5);
                }
            }


            .langSel_container {
                text-align: center;
            }

            .langSel {
                background-color: rgba(8, 7, 6, 0.8);
                border: 1px solid #d9c38f;
                width: auto;
                /* height: 50px; */
                color: white;
                font-size: 18px;
            }

                .langSel option {
                    color: white;
                    font-size: 18px;
                }

            .image_1 {
                width: 50%;
                margin: 0 25%;
            }

            .image-wrapper_1 {
                width: 600px;
                max-width: 100vw;
                height: auto;
                margin: auto;
                background-color: rgba(8, 7, 6, 0.8);
                padding: 0px 0px;
                min-height: 100vh;
            }
        }

        .gameContainer {
            width: 100vw;
            height: 100vh;
            position: fixed;
            background-color: black;
            transform: translateY(100vh);
            top: 0;
            transition: transform 0.5s;
        }

        .gameContainer-show {
            transform: translateY(0);
        }

        .game-header {
            height: 40px;
            width: 100%;
            position: relative;
            top: 0px;
            background: linear-gradient(180deg, #CDBB9D 0%, #B9A179 100%, #CDB690 100%);
            justify-content: center;
            display: flex;
            align-items: center;
        }

        .game-back {
            position: absolute;
            left: 0px;
            font-size: 32px;
            font-weight: 900;
            -webkit-text-stroke: 0.1px rgb(232 232 232);
            color: black;
            font-family: emoji;
            border: 0px;
            margin: 0px;
            line-height: 40px;
            width: 60px;
        }

        .game-reload {
            position: absolute;
            left: 60px;
            font-size: 32px;
            font-weight: 900;
            -webkit-text-stroke: 0.1px rgb(232 232 232);
            color: black;
            font-family: emoji;
            border: 0px;
            margin: 0px;
            line-height: 40px;
            width: 60px;
        }

        .game-body {
            width: 100%;
            height: calc(100% - 40px);
            position: relative;
            /* top: 40px;*/
            overflow-y: auto;
            box-sizing: border-box;
            display: flex;
        }

        .game-title {
            line-height: 40px;
            font-family: Microsoft JhengHei;
            position: relative;
            font-size: 18px;
            font-weight: bold;
            color: #373b4e;
        }

        .game-icon {
            height: 24px;
            width: 24px;
            /* vertical-align: middle; */
            top: 5px;
            position: absolute;
            left: -24px
        }

        .game-mask {
            height: 100%;
            width: 100%;
            background-color: black;
            position: absolute;
            top: 0;
        }

        .is-hide {
            display: none;
        }

        /*-----------------------------------*/

        @keyframes fadeOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                display:none;
            }
        }

        .loader-container.is-loader-hide {
            animation: fadeOut 1s; /* 持续时间为2秒，可以根据需要调整 */
            opacity: 1;
            animation-fill-mode: forwards;
        }

        .loader-container {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            z-index: 9999;
            text-align: center;
            background-color: rgb(30 30 30 / 90%);
        }

        .loader-spinner {
            width: 200px;
            height: 200px;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 100px;
            right: 0;
            margin: auto;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .sk-fading-circle {
            margin: 20px auto;
            width: 100%;
            height: 100%;
            position: relative;
        }

        .loader-logo {
            width: 80%;
            height: 80%;
            background: url(images/logo_300.png) center center no-repeat;
            background-size: calc(100% - 50px);
            -webkit-animation: loader-logo-anim 1.2s infinite ease-in-out both;
            animation: loader-logo-anim 1.2s infinite ease-in-out both;
            margin: 10%;
        }

        .sk-fading-circle {
            margin: 20px auto;
            width: 100%;
            height: 100%;
            position: relative;
        }

            .sk-fading-circle .sk-circle:before {
                content: "";
                display: block;
                margin: 0 auto;
                width: 10%;
                height: 10%;
                background-color: #fff;
                border-radius: 100%;
                -webkit-animation: sk-circleFadeDelay 1.2s infinite ease-in-out both;
                animation: sk-circleFadeDelay 1.2s infinite ease-in-out both;
            }

            .sk-fading-circle .sk-circle {
                width: 100%;
                height: 100%;
                position: absolute;
                left: 0;
                top: -10%;
            }

            .sk-fading-circle .sk-circle2 {
                -webkit-transform: rotate(30deg);
                transform: rotate(30deg);
            }

            .sk-fading-circle .sk-circle3 {
                -webkit-transform: rotate(60deg);
                transform: rotate(60deg);
            }

            .sk-fading-circle .sk-circle4 {
                -webkit-transform: rotate(90deg);
                transform: rotate(90deg);
            }

            .sk-fading-circle .sk-circle5 {
                -webkit-transform: rotate(120deg);
                transform: rotate(120deg);
            }

            .sk-fading-circle .sk-circle6 {
                -webkit-transform: rotate(150deg);
                transform: rotate(150deg);
            }

            .sk-fading-circle .sk-circle7 {
                -webkit-transform: rotate(180deg);
                transform: rotate(180deg);
            }

            .sk-fading-circle .sk-circle8 {
                -webkit-transform: rotate(210deg);
                transform: rotate(210deg);
            }

            .sk-fading-circle .sk-circle9 {
                -webkit-transform: rotate(240deg);
                transform: rotate(240deg);
            }

            .sk-fading-circle .sk-circle10 {
                -webkit-transform: rotate(270deg);
                transform: rotate(270deg);
            }

            .sk-fading-circle .sk-circle11 {
                -webkit-transform: rotate(300deg);
                transform: rotate(300deg);
            }

            .sk-fading-circle .sk-circle12 {
                -webkit-transform: rotate(330deg);
                transform: rotate(330deg);
            }

            .sk-fading-circle .sk-circle2:before {
                -webkit-animation-delay: -1.1s;
                animation-delay: -1.1s;
            }

            .sk-fading-circle .sk-circle3:before {
                -webkit-animation-delay: -1s;
                animation-delay: -1s;
            }

            .sk-fading-circle .sk-circle4:before {
                -webkit-animation-delay: -0.9s;
                animation-delay: -0.9s;
            }

            .sk-fading-circle .sk-circle5:before {
                -webkit-animation-delay: -0.8s;
                animation-delay: -0.8s;
            }

            .sk-fading-circle .sk-circle6:before {
                -webkit-animation-delay: -0.7s;
                animation-delay: -0.7s;
            }

            .sk-fading-circle .sk-circle7:before {
                -webkit-animation-delay: -0.6s;
                animation-delay: -0.6s;
            }

            .sk-fading-circle .sk-circle8:before {
                -webkit-animation-delay: -0.5s;
                animation-delay: -0.5s;
            }

            .sk-fading-circle .sk-circle9:before {
                -webkit-animation-delay: -0.4s;
                animation-delay: -0.4s;
            }

            .sk-fading-circle .sk-circle10:before {
                -webkit-animation-delay: -0.3s;
                animation-delay: -0.3s;
            }

            .sk-fading-circle .sk-circle11:before {
                -webkit-animation-delay: -0.2s;
                animation-delay: -0.2s;
            }

            .sk-fading-circle .sk-circle12:before {
                -webkit-animation-delay: -0.1s;
                animation-delay: -0.1s;
            }

        @-webkit-keyframes sk-circleFadeDelay {
            0%, 39%, 100% {
                opacity: 0;
            }

            40% {
                opacity: 1;
            }
        }

        @keyframes sk-circleFadeDelay {
            0%, 39%, 100% {
                opacity: 0;
            }

            40% {
                opacity: 1;
            }
        }

        @-webkit-keyframes loader-logo-anim {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }

            25% {
                -webkit-transform: rotate(30deg);
                transform: rotate(30deg);
            }

            75% {
                -webkit-transform: rotate(-30deg);
                transform: rotate(-30deg);
            }

            100% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }
        }

        @keyframes loader-logo-anim {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }

            25% {
                -webkit-transform: rotate(30deg);
                transform: rotate(30deg);
            }

            75% {
                -webkit-transform: rotate(-30deg);
                transform: rotate(-30deg);
            }

            100% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }
        }
    </style>
</head>
<body style="background-color: rgb(3 15 36);margin:0px">
    <div class="page flex-col" style="width: 100%; height: 100vh; background: url(images/banner.jpg) 100% repeat; background-size: 100% 100%;overflow-y: auto;">
        <div class="image-wrapper_1 flex-col">
            <img class="image_1"
                 referrerpolicy="no-referrer"
                 src="images/logo_1024.png" />

            <div class="selContainer">
                <div class="langSel_container">
                    <div class="selTitle language_replace">錢包：</div>
                    <select id="idCurrencySel" class="langSel" onchange="currencySelChange(event)">
                        <!--<option value="CNY" selected>CNY</option>
                        <option value="PUSD">PUSD</option>
                        <option value="CUSD">CUSD</option>
                        <option value="KRW">KRW</option>
                        <option value="PHP">PHP</option>
                        <option value="HKD">HKD</option>-->
                    </select>
                </div>
                <div class="langSel_container">
                    <div class="selTitle language_replace">語系：</div>
                    <select id="idlangSel" class="langSel" onchange="langSelChange(event)">
                        <option value="ENG" selected>English</option>
                        <option value="CHS">简体中文</option>
                        <option value="JPN">日本語</option>
                        <option value="KOR">한국어</option>
                        <option value="CHT">繁體中文</option>
                        <option value="THAI">Thai</option>
                    </select>
                </div>
            </div>
            <div class="containerBrand">
                <div class="brand">
                    <button data-brand="BM" class="entryGame language_replace">BM 電投</button>
                </div>
                <div class="brand">
                    <button data-brand="PS" class="entryGame language_replace">BM 體育</button>
                </div>
                <div class="brand">
                    <button data-brand="DBES" class="entryGame language_replace">BM 電競</button>
                </div>
            </div>
        </div>
    </div>
    <div id="idGameContainer" class="gameContainer">
        <div class="game-header">
            <button class="game-back" onclick="leaveGame();">↩︎</button>
            <!--<button class="game-reload" onclick="reloadGame();">⟳</button>-->
            <span class="game-title"><img class="game-icon" src="images/logo_300.png" /><span id="idTitle">電子競技</span></span>
        </div>
        <div class="game-body">
            <iframe id="idGameFrame" src="" style="height:100%;width:100%;border:0px"></iframe>
        </div>
        <div class="game-mask"></div>
    </div>
    <div class="loader-container">
        <div class="loader-box">
            <div class="loader-spinner">
                <div class="sk-fading-circle">
                    <div class="loader-logo">
                    </div>
                    <div class="sk-circle1 sk-circle"></div>
                    <div class="sk-circle2 sk-circle"></div>
                    <div class="sk-circle3 sk-circle"></div>
                    <div class="sk-circle4 sk-circle"></div>
                    <div class="sk-circle5 sk-circle"></div>
                    <div class="sk-circle6 sk-circle"></div>
                    <div class="sk-circle7 sk-circle"></div>
                    <div class="sk-circle8 sk-circle"></div>
                    <div class="sk-circle9 sk-circle"></div>
                    <div class="sk-circle10 sk-circle"></div>
                    <div class="sk-circle11 sk-circle"></div>
                    <div class="sk-circle12 sk-circle"></div>
                </div>
            </div>
        </div>
    </div>


    <script type="text/javascript" src="/Scripts/Common.js"></script>
    <script type="text/javascript" src="/Scripts/LobbyAPI.js"></script>
    <script type="text/javascript" src="/Scripts/Math.uuid.js"></script>
    <!--<script type="text/javascript" src="Scripts/MultiLanguage.js"></script>-->
    <script type="text/javascript">
        var c = new common();
        var SID;
        var CT;
        var RecoverToken;
        var CurrencyType;
        var Lang;
        var mlp;
        var p;
        var WalletInfo;
        var gameFrameOpened = false;
        /*  var mlp;*/

   
        function API_LoadingStart() {            
            document.querySelector('.loader-container').style.display = "block";
        }

        function API_LoadingEnd() {            
            document.querySelector('.loader-container').style.display = "none";
        }

        function API_ReceivePoint() {
            API_LoadingStart();
            p.ReceiveGamePointByProduct(CT, "", Math.uuid(), (success, o) => {
                p.GetUserInfoByProduct(CT, Math.uuid(), (success, o) => {
                    if (success == true) {
                        if (o.Result == 0) {
                            WalletInfo = o;
                            updateBaseInfo();
                            API_LoadingEnd();
                        } else {
                            window.location.href = "index.aspx";
                        }
                    } else {
                        window.location.href = "index.aspx";
                    }
                });
            });
        }

        function clickEntryGame(brand) {
            if (!brand) {
                brand = event.currentTarget.dataset.brand;
            }


            cb = () => {
                var Url = "GameRedirect.aspx?CT=" + encodeURIComponent(CT) + "&SelectGameBrand=" + brand + "&CurrencyType=" + CurrencyType;
                var gameTitle = "";

                if (Lang) {
                    Url += "&Lang=" + Lang;
                }


                switch (brand) {
                    case "BM":
                        gameTitle = mlp.getLanguageKey("電投");
                        break;

                    case "DBES":
                        gameTitle = mlp.getLanguageKey("電子競技");
                        break;
                    case "PS":
                        gameTitle = mlp.getLanguageKey("體育");
                        break;
                    default:
                        gameTitle = "BM";
                        break;
                }

                document.getElementById("idTitle").innerText = gameTitle;
                document.querySelector(".game-mask").classList.add("is-hide");
                document.getElementById("idGameContainer").classList.add("gameContainer-show");
                document.getElementById("idGameFrame").src = Url;

                API_LoadingStart();


                idGameFrame.onload = () => {
                    if (gameFrameOpened) {
                        API_LoadingEnd();
                    }                  
                    resize();
                };


                gameFrameOpened = true;
            };

            if (CurrencyType) {
                cb();
            } else {

            }
        }

        function leaveGame() {
            document.getElementById("idGameContainer").classList.remove("gameContainer-show");
            document.getElementById("idGameFrame").src = "";
            gameFrameOpened = false;

            API_ReceivePoint();
        }

        function reloadGame() {
            var iframe = document.getElementById('idGameFrame');
            iframe.src = iframe.src;
        }

        function updateBaseInfo() {
            if (WalletInfo) {
                var MaxCurrency;
                var MaxPointValue = 0;
                var CurrencyTypeInList = false;

                setCookie("LoginAccount", WalletInfo.LoginAccount, 365);

                idCurrencySel.innerHTML = "";

                for (var i = 0; i < WalletInfo.WalletList.length; i++) {
                    var wallet = WalletInfo.WalletList[i];
                    var opt = document.createElement("option");
                    opt.value = wallet.CurrencyType;
                    opt.innerText = wallet.CurrencyType + "  " + new BigNumber(wallet.PointValue).toFormat();

                    if (wallet.PointValue > MaxPointValue) {
                        MaxCurrency = wallet.CurrencyType;
                        MaxPointValue = wallet.PointValue;
                    }

                    if (CurrencyType) {
                        if (CurrencyTypeInList == false) {
                            CurrencyTypeInList = wallet.CurrencyType == CurrencyType;
                        }
                    } 

                    idCurrencySel.appendChild(opt);
                }

                if (CurrencyTypeInList) {
                    idCurrencySel.value = CurrencyType;
                } else {
                    if (MaxCurrency) {
                        CurrencyType = MaxCurrency;
                        idCurrencySel.value = MaxCurrency;
                    } else {
                        CurrencyType = WalletInfo.WalletList[0].CurrencyType;
                        idCurrencySel.value = WalletInfo.WalletList[0].CurrencyType;
                    }
                }
            }
        }

        function init() {
            CT = c.getParameter("CT");
            Lang = c.getParameter("Lang");
            CurrencyType = c.getParameter("CurrencyType");
            RecoverToken = c.getParameter("RecoverToken"); 
            //undefined
            p = new LobbyAPI("/API/LobbyAPI.asmx");

            if (!CT) {
                window.location.href = "index.aspx";
            } else {
                CT = decodeURIComponent(CT)
            }

            if (!RecoverToken) {

            } else {
                setCookie("RecoverToken", RecoverToken, 365);
            }

            var guid = Math.uuid();

            API_ReceivePoint();
            
            if (Lang) {
                idlangSel.value = Lang;
            } else {
                if (window.localStorage.getItem("Lang")) {
                    Lang = window.localStorage.getItem("Lang");
                }

                if (!Lang) {
                    Lang = "ENG";
                }
            }



            //mlp = new multiLanguage();

            //setLanguage(Lang, function () {

            //    //initLiveChat();
            //});


            document.getElementById("idGameContainer").addEventListener("transitionend", () => {
                // 过渡完成后执行的代码
                if (gameFrameOpened == false) {
                    document.querySelector(".game-mask").classList.add("is-hide");
                }
            });

            initGameEvents();

            resize();

            mlp = new multiLanguage();

            setLanguage(Lang, function () { });

            window.setInterval(function () {
                // refresh SID and Token;
                var guid = Math.uuid();

                p.KeepSIDByProduct(CT, guid, function (success, o) {
                    if (success == true) {
                        if (o.Result != 0) {
                            //window.location.href = "index.aspx";
                            userRecover();
                        }
                    } else {
                        //window.location.href = "index.aspx";
                        userRecover();
                    }
                });

            }, 10000);
        }

        function currencySelChange(e) {
            var sel = e.currentTarget;
            CurrencyType = sel.value;
            //setLanguage(lang);
        }

        function langSelChange(e) {
            var sel = e.currentTarget;
            Lang = sel.value;


            setLanguage(Lang, null);
            //setLanguage(lang);
        }

        function setLanguage(c, cb) {
            Lang = c;

            window.localStorage.setItem("Lang", Lang);
            idlangSel.value = Lang;

            mlp.loadLanguage(Lang, function () {
                if (cb)
                    cb();
            });
        }

        function resize() {
            var frameContainer = document.getElementById("idGameContainer");

            frameContainer.style.height = window.innerHeight + "px";

            if (gameFrameOpened == true) {
                var frame = document.getElementById("idGameFrame");

                frame.style.height = frame.contentWindow.outerHeight + "px";
                frame.style.width = frame.contentWindow.outerWidth + "px";
            }
        }

        function initGameEvents() {
            var btns = document.querySelectorAll('.entryGame');

            if (isMobileDevice()) {
                for (var i = 0; i < btns.length; i++) {
                    var btn = btns[i];
                    ((brand) => {
                        btn.addEventListener("touchend", function (event) {
                            var frameContainer = document.getElementById("idGameContainer");
                           

                            //if (frameContainer.requestFullscreen) {
                            //    frameContainer.requestFullscreen();
                            //} else if (frameContainer.mozRequestFullScreen) { // Firefox
                            //    frameContainer.mozRequestFullScreen();
                            //} else if (frameContainer.webkitRequestFullscreen) { // Chrome, Safari, 和 Opera
                            //    frameContainer.webkitRequestFullscreen();
                            //} else if (frameContainer.msRequestFullscreen) { // Internet Explorer
                            //    frameContainer.msRequestFullscreen();
                            //}

                            clickEntryGame(brand);
                        });
                    })(btn.dataset.brand);
                }           
            } else {
                for (var i = 0; i < btns.length; i++) {
                    var btn = btns[i];
                    ((brand) => {
                        btn.addEventListener("click", function (event) {
                            clickEntryGame(brand);
                        });
                    })(btn.dataset.brand);
                }           
            }            
        }

        function isMobileDevice() {
            const mobileKeywords = [
                "Android",
                "iPhone",
                "iPad",
                "Windows Phone",
                "BlackBerry",
                "Nokia",
                "Mobile"
            ];

            const userAgent = navigator.userAgent;

            for (const keyword of mobileKeywords) {
                if (userAgent.includes(keyword)) {
                    return true;
                }
            }

            return false;
        }

        function userRecover() {
            var recoverToken = getCookie("RecoverToken");
            var LoginAccount = getCookie("LoginAccount");

            if ((recoverToken != null) && (recoverToken != "")) {
                var postData;
                postData = {
                    "RecoverToken": recoverToken,
                    "LoginAccount": LoginAccount
                }
                c.callService("/LoginRecover.aspx", postData, function (success, o) {

                    if (success) {
                        var obj = c.getJSON(o);

                        if (obj.ResultCode == 0) {
                            setCookie("RecoverToken", obj.RecoverToken, 365);
                            setCookie("LoginAccount", obj.LoginAccount, 365);
                            setCookie("CT", obj.CT, 365);
                            CT = obj.CT;
                        } else {
                            window.location.href = "index.aspx";
                        }
                    } else {
                        window.location.href = "index.aspx";
                    }
                });
            } else {
                window.location.href = "index.aspx";
            }
        }

        //#region Cookie
        function getCookie(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

        function setCookie(cname, cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }

        function delCookie(name) {
            var exp = new Date();
            exp.setTime(exp.getTime() - 1);
            cval = getCookie(name);
            if (cval != null) document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString();
        }
    //#endregion

        window.onload = init;
        window.onresize = resize;

    </script>
</body>
</html>
